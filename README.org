
* submission_file_viewer

submission_file_viewer は Google Classroom の提出ファイルを一覧で表示する Google Apps Script (GAS) のプログラムです。

Classroom 標準の機能では提出ファイルを一覧で表示できませんので、提出ファイルのチェックを効率化するためにこのプログラムを作りました。

** 特徴

 - Classroom の課題に対応するフォルダを選んで、提出されたファイルで未返却のものを一覧表示することができます。
 - 課題ファイルは提出者ごとにまとめて表示されます。
 - 表示できるファイルは jpg や png などの画像ファイルと pdf ファイルです。
 - 画像ファイルは90°ごとに回転させて表示することもできます。
 - pdf ファイルは Google Drive の表示機能を使い埋め込みで表示しています。
 - 一覧では提出者の学籍番号（メールアドレス）や提出日時で並べ替えを行うことができます。
 - プログラムでは Classroom API は使用せず、 Drive API を使ってファイルを表示しています。

** 使用法

*** 提出課題の表示

 - 始めは Google Drive の「マイドライブ」のフォルダ・ファイル一覧が表示されます。
 - Classroom フォルダをダブルクリック選んで、表示対象科目を選びます。
 - 科目フォルダには課題ごとのフォルダがあるので、表示対象課題を選びます。
 - 課題フォルダに入ると、提出されたファイルの一覧が表示されます。
 - ファイル一覧で一覧表示対象外のファイルは背景が暗く表示されます。
   + 一覧表示対象ファイルは以下の通りです
     * 提出済みで返却していないファイル
   + 一覧表示対象外ファイルは以下の通りです
     * ファイル作成後に提出されなかったファイル
     * 提出後に提出を取り消したファイル
     * 提出後に返却されたファイル
 - ファイル一覧が表示されてい状態で「課題一覧表示」ボタンをクリックす
   ると、表示対象となっている課題ファイルが一覧表示されます。
 - 画像読み込み中は「loading a image ...」と表示されます。
 - ネットワークの回線状況などにより「loading a image ...」のまま画像が表示されないことがありますので、その場合は「再読込」ボタンで再読込みを行って下さい。

*** 提出課題表示での設定

 - 選べる「対象課題」は「提出済み・未返却」のみです。
 - 「画像幅」で表示する画像の幅を設定します。
 - 「並べ替え」で並べ替えの対象を選びます。
   + 「学籍番号」は提出者のメールアドレスです。
   + 「最終更新日時」は提出ファイルの最終更新日時です。
   + 提出ファイルが複数ある場合は、最も最終更新日時の遅いものが「最終更新日時」として使用されます。
 - 「並べ替え方法」で「並べ替え」方法を選びます。
   + 「小→大」はアルファベットなら a → z の順、数値なら 1 → 9 の順になります。
   + 「大→小」はアルファベットなら z → a の順、数値なら 9 → 1 の順になります。
 - 「画像表示」で画像を表示するか否かを選びます。

*** 設定の保存とリセット

 - 選択中のフォルダと一覧表示の設定は保存されるようになっています。
 - プログラムを再度実行したときは保存された設定が既定値となります。
 - 設定のリセットは実行画面右上の▼から表示されるメニューで行うことができます。
   + 「初期フォルダ設定リセット」でプログラム開始時のフォルダ設定がリセットされます。
   + 「課題一覧表示設定リセット」で課題一覧表示の設定がリセットされます。
   + 「全ての設定をリセット」で上記の2つがリセットされます。

** プログラムの実行

 - このプログラムは Google Apps Script (GAS)  の web アプリとして実行することができます。
 - プログラムを実行するためには Google アカウントでログインを行い、GAS 開発用のスクリプトエディタを使って各ファイルを追加し、ウェブアプリケーションとして公開する必要があります。

** プログラムの変更

 - 学校・大学によってはメールアドレスが学籍番号や学科名に対応していることもありますので、プログラムに関数を追加することで、メールアドレスから学籍番号や学科名を作ることができるようになっています。
 - メールアドレスを引数とする getStudentId という関数がある場合は、その関数で加工したものが学籍番号として使用されます。
 - 同じくメールアドレスを引数とする getDepartmentName という関数がある場合は、その関数で加工したものが学科名として提出者名の後に表示されます。
  - また、提出者名を引数とする getStudentName 関数がある場合は、その関数で加工したものが提出者名として使用されます。
 - 適当なスクリプトファイルを追加し、上記の関数を作ると、各学校・大学に応じた出力が得られます。

** 注意事項など

 - このプログラムは Classroom の課題で提出されたファイルを一覧表示する目的で作られています。
 - 正しく動作することを意図して作りましたが、動作は保証しません。
 - プログラムを実行する前に Google の拡張サービスとして Drive API の利用を ON にする必要があります。
 - プログラムを実行するときには Google Drive へのアクセスを許可する必要があり、初回の実行時に承認作業を行う必要があります。
 - このプログラムは Classroom API が使えない環境で作成されていますので、 Google Drive API を使って、提出課題ファイルの表示を実現しています。
 - Classroom API を使用した、提出状況や成績などの確認はできませんのでご注意下さい。
